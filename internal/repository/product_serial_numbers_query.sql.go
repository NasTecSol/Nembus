// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: product_serial_numbers_query.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createProductSerialNumber = `-- name: CreateProductSerialNumber :one
INSERT INTO product_serial_numbers (
    product_id,
    product_variant_id,
    serial_number,
    status,
    current_store_id,
    manufacturing_date,
    expiry_date,
    metadata
) VALUES (
    $1, $2, $3, $4, $5, $6, $7, $8
) RETURNING id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at
`

type CreateProductSerialNumberParams struct {
	ProductID         int32       `json:"product_id"`
	ProductVariantID  pgtype.Int4 `json:"product_variant_id"`
	SerialNumber      string      `json:"serial_number"`
	Status            pgtype.Text `json:"status"`
	CurrentStoreID    pgtype.Int4 `json:"current_store_id"`
	ManufacturingDate pgtype.Date `json:"manufacturing_date"`
	ExpiryDate        pgtype.Date `json:"expiry_date"`
	Metadata          []byte      `json:"metadata"`
}

func (q *Queries) CreateProductSerialNumber(ctx context.Context, arg CreateProductSerialNumberParams) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, createProductSerialNumber,
		arg.ProductID,
		arg.ProductVariantID,
		arg.SerialNumber,
		arg.Status,
		arg.CurrentStoreID,
		arg.ManufacturingDate,
		arg.ExpiryDate,
		arg.Metadata,
	)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteProductSerialNumber = `-- name: DeleteProductSerialNumber :exec
DELETE FROM product_serial_numbers
WHERE id = $1
`

func (q *Queries) DeleteProductSerialNumber(ctx context.Context, id int32) error {
	_, err := q.db.Exec(ctx, deleteProductSerialNumber, id)
	return err
}

const getExpiredSerialNumbers = `-- name: GetExpiredSerialNumbers :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE expiry_date < CURRENT_DATE
  AND status = 'in_stock'
ORDER BY expiry_date
`

func (q *Queries) GetExpiredSerialNumbers(ctx context.Context) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, getExpiredSerialNumbers)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getExpiringSerialNumbers = `-- name: GetExpiringSerialNumbers :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE expiry_date BETWEEN CURRENT_DATE AND $1
  AND status = 'in_stock'
ORDER BY expiry_date
`

func (q *Queries) GetExpiringSerialNumbers(ctx context.Context, expiryDate pgtype.Date) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, getExpiringSerialNumbers, expiryDate)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getProductSerialNumber = `-- name: GetProductSerialNumber :one
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE id = $1
`

func (q *Queries) GetProductSerialNumber(ctx context.Context, id int32) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, getProductSerialNumber, id)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getProductSerialNumberBySerial = `-- name: GetProductSerialNumberBySerial :one
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE serial_number = $1
`

func (q *Queries) GetProductSerialNumberBySerial(ctx context.Context, serialNumber string) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, getProductSerialNumberBySerial, serialNumber)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const listAvailableSerialNumbers = `-- name: ListAvailableSerialNumbers :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE product_id = $1 
  AND status = 'in_stock'
  AND current_store_id = $2
ORDER BY serial_number
`

type ListAvailableSerialNumbersParams struct {
	ProductID      int32       `json:"product_id"`
	CurrentStoreID pgtype.Int4 `json:"current_store_id"`
}

func (q *Queries) ListAvailableSerialNumbers(ctx context.Context, arg ListAvailableSerialNumbersParams) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, listAvailableSerialNumbers, arg.ProductID, arg.CurrentStoreID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listProductSerialNumbers = `-- name: ListProductSerialNumbers :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
ORDER BY created_at DESC
`

func (q *Queries) ListProductSerialNumbers(ctx context.Context) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, listProductSerialNumbers)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listProductSerialNumbersByProduct = `-- name: ListProductSerialNumbersByProduct :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE product_id = $1
ORDER BY serial_number
`

func (q *Queries) ListProductSerialNumbersByProduct(ctx context.Context, productID int32) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, listProductSerialNumbersByProduct, productID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listProductSerialNumbersByStatus = `-- name: ListProductSerialNumbersByStatus :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE status = $1
ORDER BY serial_number
`

func (q *Queries) ListProductSerialNumbersByStatus(ctx context.Context, status pgtype.Text) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, listProductSerialNumbersByStatus, status)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listProductSerialNumbersByStore = `-- name: ListProductSerialNumbersByStore :many
SELECT id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at FROM product_serial_numbers
WHERE current_store_id = $1
ORDER BY serial_number
`

func (q *Queries) ListProductSerialNumbersByStore(ctx context.Context, currentStoreID pgtype.Int4) ([]ProductSerialNumber, error) {
	rows, err := q.db.Query(ctx, listProductSerialNumbersByStore, currentStoreID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ProductSerialNumber
	for rows.Next() {
		var i ProductSerialNumber
		if err := rows.Scan(
			&i.ID,
			&i.ProductID,
			&i.ProductVariantID,
			&i.SerialNumber,
			&i.Status,
			&i.CurrentStoreID,
			&i.ManufacturingDate,
			&i.ExpiryDate,
			&i.Metadata,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const transferSerialNumber = `-- name: TransferSerialNumber :one
UPDATE product_serial_numbers
SET 
    current_store_id = $2,
    status = $3
WHERE serial_number = $1
RETURNING id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at
`

type TransferSerialNumberParams struct {
	SerialNumber   string      `json:"serial_number"`
	CurrentStoreID pgtype.Int4 `json:"current_store_id"`
	Status         pgtype.Text `json:"status"`
}

func (q *Queries) TransferSerialNumber(ctx context.Context, arg TransferSerialNumberParams) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, transferSerialNumber, arg.SerialNumber, arg.CurrentStoreID, arg.Status)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateProductSerialNumber = `-- name: UpdateProductSerialNumber :one
UPDATE product_serial_numbers
SET 
    status = $2,
    current_store_id = $3,
    metadata = $4
WHERE id = $1
RETURNING id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at
`

type UpdateProductSerialNumberParams struct {
	ID             int32       `json:"id"`
	Status         pgtype.Text `json:"status"`
	CurrentStoreID pgtype.Int4 `json:"current_store_id"`
	Metadata       []byte      `json:"metadata"`
}

func (q *Queries) UpdateProductSerialNumber(ctx context.Context, arg UpdateProductSerialNumberParams) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, updateProductSerialNumber,
		arg.ID,
		arg.Status,
		arg.CurrentStoreID,
		arg.Metadata,
	)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateSerialNumberStatus = `-- name: UpdateSerialNumberStatus :one
UPDATE product_serial_numbers
SET status = $2
WHERE serial_number = $1
RETURNING id, product_id, product_variant_id, serial_number, status, current_store_id, manufacturing_date, expiry_date, metadata, created_at, updated_at
`

type UpdateSerialNumberStatusParams struct {
	SerialNumber string      `json:"serial_number"`
	Status       pgtype.Text `json:"status"`
}

func (q *Queries) UpdateSerialNumberStatus(ctx context.Context, arg UpdateSerialNumberStatusParams) (ProductSerialNumber, error) {
	row := q.db.QueryRow(ctx, updateSerialNumberStatus, arg.SerialNumber, arg.Status)
	var i ProductSerialNumber
	err := row.Scan(
		&i.ID,
		&i.ProductID,
		&i.ProductVariantID,
		&i.SerialNumber,
		&i.Status,
		&i.CurrentStoreID,
		&i.ManufacturingDate,
		&i.ExpiryDate,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
